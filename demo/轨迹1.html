<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>轨迹-可控制</title>
    <link rel="stylesheet" href="../libs/leaflet/leaflet.css">
    <script src="../libs/jquery/jquery-3.2.1.min.js"></script>
    <script src="../libs/leaflet/leaflet.js"></script>
    <script src="../libs/leaflet/MovingMarker.js"></script>
    <script src="../libs/leaflet/leaflet.polylineDecorator.js"></script>
    <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            cursor: default;
        }
    </style>
</head>
<body>
<div id="map">
</div>
<div style="position: absolute; top: 50px; left: 50px; z-index: 999">
    <button onclick="start()">开始</button>
    <button onclick="pause()">暂停</button>
    <button onclick="stop()">结束</button>
</div>
<script>

    var map = L.map('map',{maxZoom:20}).setView([49.363093, 120.6657223], 16);
    // L.tileLayer('http://t{s}.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}', {subdomains: ['0', '1', '2', '3', '4', '5', '6', '7']}).addTo(this.map);
    L.tileLayer('http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}').addTo(this.map);
    L.tileLayer('http://t{s}.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}', {subdomains: ['0', '1', '2', '3', '4', '5', '6', '7']}).addTo(this.map);

    var parisKievLL = [
        [49.40198150568293, 120.67904233932497],
        [49.40198150568293, 120.67842006683351],
        [49.40193961505609, 120.67771196365358],
        [49.401869797265284, 120.67726135253908],
        [49.40173016138585, 120.6762957572937],
        [49.401660343297245, 120.67552328109743],
        [49.40157656145988, 120.67490100860596],
        [49.401534670487585, 120.67432165145875],
        [49.40146485212102, 120.67382812500001],
        [49.401367106241075, 120.67329168319704],
        [49.401241432680955, 120.67254066467287],
        [49.401157650128866, 120.67163944244386],
        [49.401031976032705, 120.67095279693605],
        [49.40096215695144, 120.67013740539552],
        [49.40078062687551, 120.66932201385498],
        [49.400738735224245, 120.66872119903566],
        [49.4006828796336, 120.66816329956056],
        [49.40055720432239, 120.66756248474121],
        [49.40052927643179, 120.66704750061037],
        [49.40031981674593, 120.66595315933229],
        [49.400263960678835, 120.6652879714966],
        [49.40013828429555, 120.6647300720215],
        [49.400054499861334, 120.66404342651369],
        [49.39997071528417, 120.66357135772706],
        [49.39988693056408, 120.66307783126832],
        [49.39978918154328, 120.66258430480958],
        [49.39974728904624, 120.6620478630066],
        [49.39949593331354, 120.66213369369508],
        [49.399621611340706, 120.66277742385866],
        [49.39969143232792, 120.66320657730104],
        [49.39974728904624, 120.66363573074342],
        [49.399845038150424, 120.66415071487428],
        [49.39990089469402, 120.66475152969362],
        [49.400040535775055, 120.66558837890626],
        [49.40012432023309, 120.6662964820862],
        [49.40020810454818, 120.66683292388917],
        [49.40030585273512, 120.66736936569215],
        [49.40036170875459, 120.66788434982301],
        [49.4003896367405, 120.6683135032654],
        [49.400766662995714, 120.67086696624757],
        [49.40087837392284, 120.67146778106691],
        [49.40110179501474, 120.67391395568849],
        [49.401199541422784, 120.67457914352418],
        [49.40128332390341, 120.67530870437623],
        [49.401395033655206, 120.67620992660524],
        [49.40154863414899, 120.67747592926027],
        [49.401716197776075, 120.67842006683351],
        [49.401758088593525, 120.67908525466919],
        [49.401395033655206, 120.67936420440675],
        [49.40138106995014, 120.67850589752199],
        [49.40125539642574, 120.67781925201417],
        [49.40121350517948, 120.67721843719484],
        [49.40108783122626, 120.67642450332643],
        [49.4010040484121, 120.6757164001465],
        [49.40096215695144, 120.67496538162233],
        [49.40083648235496, 120.67406415939332],
        [49.4007945907513, 120.67344188690187],
        [49.40072477133252, 120.67290544509889],
        [49.400654951814445, 120.67217588424684],
        [49.40059909612853, 120.67170381546022],
        [49.40059909612853, 120.67108154296876],
        [49.400445492664645, 120.6703519821167],
        [49.40040360072749, 120.66983699798585],
        [49.40024999665212, 120.66927909851076],
        [49.40020810454818, 120.66882848739625],
        [49.40011035616669, 120.66837787628175],
        [49.400012607590625, 120.66773414611818],
        [49.39987296643015, 120.66711187362672],
        [49.39974728904624, 120.66636085510255],
        [49.399677468138414, 120.66578149795534],
        [49.39960764713133, 120.665180683136],
        [49.3995238617918, 120.66460132598878],
        [49.399440076309325, 120.66400051116945],
        [49.399286469220165, 120.66346406936647],
        [49.39921664765718, 120.66284179687501],
        [49.39909096859365, 120.66239118576051]
    ];

    var pointLen = parisKievLL.length;
    var time = [];
    for (var i = 0; i < pointLen - 1; i++) {
        time.push(3000);
    }
    var marker2 = L.Marker.movingMarker(parisKievLL, time, {
        autostart: true,
        icon: L.icon({
            iconUrl: './car.png', iconSize: [16, 16],
            iconAnchor: [8,8]
        })
    }).addTo(map);
    L.polyline(parisKievLL, {color: '#444', weight:18}).addTo(map);
    L.polyline(parisKievLL, {color: '#fff', weight: 2, opacity: 1, dashArray: '10,10'}).addTo(map);
    // L.polyline(parisKievLL, {color: '#CDC9C9', weight:18}).addTo(map);
    // L.polyline(parisKievLL, {color: '#363636', weight: 2, opacity: 1, dashArray: '10,10'}).addTo(map);



    L.polylineDecorator(parisKievLL, {
        patterns: [
            {offset: 0, repeat: 100, symbol: L.Symbol.arrowHead({pixelSize: 10, pathOptions: {color:"#fff", fillOpacity: 1, weight: 0}})}
        ]
    }).addTo(map);
    map.fitBounds(parisKievLL);

    function start() {
        marker2.start();
    }

    function pause() {
        marker2.pause();
    }

    function stop() {
        marker2.stop();
    }
</script>
</body>
</html>